@model IdentityViewModel

<h1 class="titleView">Beheer Gebruikers en Rollen</h1>

<div class="row d-flex justify-content-center">
    <div class="col-md-4">
        <form asp-action="FormHandler">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <div class="form-group">
                <label asp-for="Users" class="control-label">Gebruikers</label>
                <select asp-for="Users" class="form-control" asp-items="ViewBag.Users" id="options" name="selectedUser" onchange="getSelectedOption()"></select>
            </div>
            <div class="form-group">
                <label asp-for="Roles" class="control-label">Rollen</label>
                <select asp-for="Roles" class="form-control">
                    @for(int i = 0; i < ViewBag.Roles.Count(); i++)
                    {
                        <option value="@i">@i</option>
                    }
                </select>
            </div>
            <div class="form-group d-flex justify-content-between">
                <a class="btn-sm backArrow" asp-action="Identity" asp-controller="Account">
                    <img src="~/img/arrow-left-black.png" height="16" />
                    <span>Terug</span>
                </a>
                <div class="btn-group">
                    <input type="submit" value="Remove Role" name="submitButton" class="btn btn-outline-danger btn-sm viewButton" />
                    <input type="submit" value="Add Role" name="submitButton" class="btn btn-outline-success btn-sm viewButton" />
                </div>
            </div>
        </form>
    </div>
</div>

<script>
    // De 2 selectLists op deze pagina hebben een attribute die "multiple" noemt, dit verwijdert ze
    var selectElements = document.querySelectorAll(".form-control");
    for (var i = 0; i < selectElements.length; i++) {
        selectElements[i].removeAttribute("multiple");
    }

    // Changes the Roles that are shown in the SelectList according to the selected User
    function getSelectedOption() {
        var selectedUser = $("#options").val();
        $.ajax({
            url: "/Account/GetRoles",
            type: "POST",
            data: { selectedUser: selectedUser },
            //success: function (result) {
            //    location.reload()
            //}
        });
    }
</script>

